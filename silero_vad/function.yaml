kind: job
metadata:
  name: silero-vad
  tag: ''
  hash: 91c431213c8b73fff2f8f02f4ddbb51058aeca27
  project: ''
  labels:
    author: guyl
  categories:
  - Deep Learning
  - PyTorch
  - Audio
spec:
  command: ''
  args: []
  image: ''
  build:
    functionSourceCode: IyBDb3B5cmlnaHQgMjAyNCBJZ3VhemlvCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQojIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiMgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiMgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAojIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgppbXBvcnQgbG9nZ2luZwpmcm9tIG11bHRpcHJvY2Vzc2luZyBpbXBvcnQgUHJvY2VzcywgUXVldWUKZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmZyb20gdHlwZXMgaW1wb3J0IEZ1bmN0aW9uVHlwZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgVHVwbGUsIFR5cGUsIFVuaW9uCgppbXBvcnQgdG9yY2gKaW1wb3J0IHRvcmNoYXVkaW8KZnJvbSB0cWRtIGltcG9ydCB0cWRtCgoKY2xhc3MgQmFzZVRhc2s6CiAgICAiIiIKICAgIEEgYmFzZSBjbGFzcyBmb3IgYSB0YXNrIHRvIGNvbXBsZXRlIGFmdGVyIFZBRC4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhdWRpb19maWxlOiBQYXRoKToKICAgICAgICAiIiIKICAgICAgICBJbml0aWFsaXplIHRoZSBiYXNlIHRhc2suCgogICAgICAgIDpwYXJhbSBhdWRpb19maWxlOiBUaGUgYXVkaW8gZmlsZSBhc3NpZ25lZCB0byB0aGUgdGFzay4KICAgICAgICAiIiIKICAgICAgICAjIFN0b3JlIHRoZSBhdWRpbyBmaWxlOgogICAgICAgIHNlbGYuX2F1ZGlvX2ZpbGUgPSBhdWRpb19maWxlCgogICAgICAgICMgUHJlcGFyZSB0aGUgcmVzdWx0OgogICAgICAgIHNlbGYuX3Jlc3VsdCA9IE5vbmUKCiAgICBAcHJvcGVydHkKICAgIGRlZiBhdWRpb19maWxlKHNlbGYpIC0+IFBhdGg6CiAgICAgICAgIiIiCiAgICAgICAgR2V0IHRoZSBhdWRpbyBmaWxlIG9mIHRoZSB0YXNrLgoKICAgICAgICA6cmV0dXJuczogVGhlIGF1ZGlvIGZpbGUgb2YgdGhlIHRhc2suCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2F1ZGlvX2ZpbGUKCiAgICBkZWYgZG9fdGFzaygKICAgICAgICBzZWxmLCBzcGVlY2hfdGltZXN0YW1wczogVW5pb25bTGlzdFtEaWN0W3N0ciwgaW50XV0sIExpc3RbTGlzdFtEaWN0W3N0ciwgaW50XV1dXQogICAgKToKICAgICAgICAiIiIKICAgICAgICBEbyB0aGUgdGFzayBvbiB0aGUgZ2l2ZW4gc3BlZWNoIHRpbWVzdGFtcHMuIFRoZSBiYXNlIHRhc2sgd2lsbCBzaW1wbHkgc2F2ZSB0aGUgc3BlZWNoIHRpbWVzdGFtcHMgYXMgdGhlIHJlc3VsdC4KCiAgICAgICAgOnBhcmFtIHNwZWVjaF90aW1lc3RhbXBzOiBUaGUgc3BlZWNoIHRpbWVzdGFtcHMgdG8gZG8gdGhlIHRhc2sgb24gYXMgb3V0cHV0dGVkIGZyb20gdGhlIFZBRC4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9yZXN1bHQgPSBzcGVlY2hfdGltZXN0YW1wcwoKICAgIGRlZiBnZXRfcmVzdWx0KHNlbGYpIC0+IFR1cGxlW3N0ciwgbGlzdF06CiAgICAgICAgIiIiCiAgICAgICAgR2V0IHRoZSByZXN1bHQgb2YgdGhlIHRhc2suIEEgdHVwbGUgb2YgdGhlIGF1ZGlvIGZpbGUgbmFtZSBhbmQgdGhlIHJlc3VsdC4KCiAgICAgICAgOnJldHVybnM6IFRoZSByZXN1bHQgb2YgdGhlIHRhc2suCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2F1ZGlvX2ZpbGUubmFtZSwgc2VsZi5fcmVzdWx0CgoKY2xhc3MgU3BlZWNoRGlhcml6YXRpb25UYXNrKEJhc2VUYXNrKToKICAgICIiIgogICAgQSBzcGVlY2ggZGlhcml6YXRpb24gdGFzay4gVGhlIHRhc2sgd2lsbCBkaWFyaXplIHRoZSBWQUQgc3BlZWNoIHRpbWVzdGFtcHMgaW50byBzcGVha2Vycy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhdWRpb19maWxlOiBQYXRoLCBzcGVha2VyX2xhYmVsczogTGlzdFtzdHJdKToKICAgICAgICAiIiIKICAgICAgICBJbml0aWFsaXplIHRoZSBzcGVlY2ggZGlhcml6YXRpb24gdGFzay4KCiAgICAgICAgOnBhcmFtIGF1ZGlvX2ZpbGU6ICAgICBUaGUgYXVkaW8gZmlsZSBhc3NpZ25lZCB0byB0aGUgdGFzay4KICAgICAgICA6cGFyYW0gc3BlYWtlcl9sYWJlbHM6IFRoZSBzcGVha2VyIGxhYmVscyB0byB1c2UgZm9yIHRoZSBkaWFyaXphdGlvbi4gSWYgbm90IGdpdmVuLCB0aGUgc3BlYWtlcnMgd2lsbCBiZSBuYW1lZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNwZWFrZXJfMCIsICJzcGVha2VyXzEiLCBldGMuCiAgICAgICAgIiIiCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhhdWRpb19maWxlPWF1ZGlvX2ZpbGUpCiAgICAgICAgc2VsZi5fc3BlYWtlcl9sYWJlbHMgPSBzcGVha2VyX2xhYmVscwoKICAgIGRlZiBkb190YXNrKHNlbGYsIHNwZWVjaF90aW1lc3RhbXBzOiBMaXN0W0xpc3RbRGljdFtzdHIsIGludF1dXSk6CiAgICAgICAgIiIiCiAgICAgICAgRG8gdGhlIHRhc2sgb24gdGhlIGdpdmVuIHNwZWVjaCB0aW1lc3RhbXBzLiBUaGUgdGFzayB3aWxsIGRpYXJpemUgdGhlIFZBRCBzcGVlY2ggdGltZXN0YW1wcyBpbnRvIHNwZWFrZXJzLgoKICAgICAgICA6cGFyYW0gc3BlZWNoX3RpbWVzdGFtcHM6IFRoZSBzcGVlY2ggdGltZXN0YW1wcyBwZXIgY2hhbm5lbCB0byBkbyB0aGUgdGFzayBvbiBhcyBvdXRwdXR0ZWQgZnJvbSB0aGUgVkFELgogICAgICAgICIiIgogICAgICAgICMgR2V0IHRoZSBzcGVha2VyIGxhYmVscyAoc2V0IGRlZmF1bHQgaWYgbm90IGdpdmVuKToKICAgICAgICBzcGVha2VyX2xhYmVscyA9IHNlbGYuX3NwZWFrZXJfbGFiZWxzIG9yIFsKICAgICAgICAgICAgZiJzcGVha2VyX3tpfSIgZm9yIGkgaW4gcmFuZ2UobGVuKHNwZWVjaF90aW1lc3RhbXBzKSkKICAgICAgICBdCgogICAgICAgICMgRGlhcml6ZSAtIG9yZ2FuaXplIHRoZSBzcGVlY2ggdGltZXN0YW1wcyBpbnRvIGEgc2luZ2xlIGxpc3Qgb2Ygc3BlYWtlcnMgYW5kIHNvcnQgaXQgYnkgc3RhcnQgdGltZToKICAgICAgICBzcGVlY2hfZGlhcml6YXRpb24gPSBbCiAgICAgICAgICAgIChzcGVlY2hfdGltZXN0YW1wWyJzdGFydCJdLCBzcGVlY2hfdGltZXN0YW1wWyJlbmQiXSwgc3BlYWtlcl9sYWJlbCkKICAgICAgICAgICAgZm9yIHNwZWFrZXJfbGFiZWwsIGNoYW5uZWxfc3BlZWNoX3RpbWVzdGFtcHMgaW4gemlwKAogICAgICAgICAgICAgICAgc3BlYWtlcl9sYWJlbHMsIHNwZWVjaF90aW1lc3RhbXBzCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIHNwZWVjaF90aW1lc3RhbXAgaW4gY2hhbm5lbF9zcGVlY2hfdGltZXN0YW1wcwogICAgICAgIF0KICAgICAgICBzcGVlY2hfZGlhcml6YXRpb24uc29ydCgpCiAgICAgICAgc2VsZi5fcmVzdWx0ID0gc3BlZWNoX2RpYXJpemF0aW9uCgoKY2xhc3MgVGFza0NyZWF0b3I6CiAgICAiIiIKICAgIEEgdGFzayBjcmVhdG9yIHRvIGNyZWF0ZSBkaWZmZXJlbnQgdGFza3MgdG8gcnVuIGFmdGVyIHRoZSBWQUQuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGFza190eXBlOiBUeXBlW0Jhc2VUYXNrXSwgdGFza19rd2FyZ3M6IGRpY3QgPSBOb25lKToKICAgICAgICAiIiIKICAgICAgICBJbml0aWFsaXplIHRoZSB0YXNrIGNyZWF0b3IuCiAgICAgICAgOnBhcmFtIHRhc2tfdHlwZTogVGhlIHRhc2sgdHlwZSAtIGEgYEJhc2VUYXNrYCBzdWJjbGFzcy4KICAgICAgICA6cGFyYW0gdGFza19rd2FyZ3M6IEFkZGl0aW9uYWwga2V5d29yZCBhcmd1bWVudHMgdG8gcGFzcyB0byB0aGUgdG8gYmUgY3JlYXRlZCB0YXNrcy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl90YXNrX3R5cGUgPSB0YXNrX3R5cGUKICAgICAgICBzZWxmLl90YXNrX2t3YXJncyA9IHRhc2tfa3dhcmdzIG9yIHt9CgogICAgZGVmIGNyZWF0ZV90YXNrKHNlbGYsIGF1ZGlvX2ZpbGU6IFBhdGgpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZSBhIHRhc2sgd2l0aCB0aGUgZ2l2ZW4gYXVkaW8gZmlsZS4KCiAgICAgICAgOnBhcmFtIGF1ZGlvX2ZpbGU6IFRoZSBhdWRpbyBmaWxlIHRvIGFzc2lnbiB0byB0aGUgdGFzay4KCiAgICAgICAgOnJldHVybnM6IFRoZSBjcmVhdGVkIHRhc2suCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX3Rhc2tfdHlwZShhdWRpb19maWxlPWF1ZGlvX2ZpbGUsICoqc2VsZi5fdGFza19rd2FyZ3MpCgoKY2xhc3MgVm9pY2VBY3Rpdml0eURldGVjdG9yOgogICAgIiIiCiAgICBBIHZvaWNlIGFjdGl2aXR5IGRldGVjdGlvbiB3cmFwcGVyIGZvciB0aGUgc2lsZXJvIFZBRCBtb2RlbCAtIGh0dHBzOi8vZ2l0aHViLmNvbS9zbmFrZXJzNC9zaWxlcm8tdmFkLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgIyBNb2RlbCBsb2FkaW5nIGt3YXJnczoKICAgICAgICB1c2Vfb25ueDogYm9vbCA9IFRydWUsCiAgICAgICAgZm9yY2Vfb25ueF9jcHU6IGJvb2wgPSBUcnVlLAogICAgICAgICMgRGV0ZWN0aW9uIGt3YXJnczoKICAgICAgICB0aHJlc2hvbGQ6IGZsb2F0ID0gMC41LAogICAgICAgIHNhbXBsaW5nX3JhdGU6IGludCA9IDE2XzAwMCwKICAgICAgICBtaW5fc3BlZWNoX2R1cmF0aW9uX21zOiBpbnQgPSAyNTAsCiAgICAgICAgbWF4X3NwZWVjaF9kdXJhdGlvbl9zOiBmbG9hdCA9IGZsb2F0KCJpbmYiKSwKICAgICAgICBtaW5fc2lsZW5jZV9kdXJhdGlvbl9tczogaW50ID0gMTAwLAogICAgICAgIHdpbmRvd19zaXplX3NhbXBsZXM6IGludCA9IDUxMiwKICAgICAgICBzcGVlY2hfcGFkX21zOiBpbnQgPSAzMCwKICAgICAgICByZXR1cm5fc2Vjb25kczogYm9vbCA9IEZhbHNlLAogICAgICAgIHBlcl9jaGFubmVsOiBib29sID0gRmFsc2UsCiAgICApOgogICAgICAgICIiIgogICAgICAgIEluaXRpYWxpemUgdGhlIHZvaWNlIGFjdGl2aXR5IGRldGVjdG9yLgoKICAgICAgICA6cGFyYW0gdXNlX29ubng6ICAgICAgICAgICAgICAgIFdoZXRoZXIgdG8gdXNlIE9OTlggZm9yIGluZmVyZW5jZS4gRGVmYXVsdCBpcyBUcnVlLgogICAgICAgIDpwYXJhbSBmb3JjZV9vbm54X2NwdTogICAgICAgICAgV2hldGhlciB0byBmb3JjZSBPTk5YIHRvIHVzZSBDUFUgZm9yIGluZmVyZW5jZS4gRGVmYXVsdCBpcyBUcnVlLgogICAgICAgIDpwYXJhbSB0aHJlc2hvbGQ6ICAgICAgICAgICAgICAgU3BlZWNoIHRocmVzaG9sZC4gU2lsZXJvIFZBRCBvdXRwdXRzIHNwZWVjaCBwcm9iYWJpbGl0aWVzIGZvciBlYWNoIGF1ZGlvIGNodW5rLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvYmFiaWxpdGllcyBBQk9WRSB0aGlzIHZhbHVlIGFyZSBjb25zaWRlcmVkIGFzIFNQRUVDSC4gSXQgaXMgYmV0dGVyIHRvIHR1bmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMgcGFyYW1ldGVyIGZvciBlYWNoIGRhdGFzZXQgc2VwYXJhdGVseSwgYnV0ICJsYXp5IiAwLjUgaXMgcHJldHR5IGdvb2QgZm9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3N0IGRhdGFzZXRzLgogICAgICAgIDpwYXJhbSBzYW1wbGluZ19yYXRlOiAgICAgICAgICAgQ3VycmVudGx5LCBzaWxlcm8gVkFEIG1vZGVscyBzdXBwb3J0IDgwMDAgYW5kIDE2MDAwIHNhbXBsZSByYXRlcy4KICAgICAgICA6cGFyYW0gbWluX3NwZWVjaF9kdXJhdGlvbl9tczogIEZpbmFsIHNwZWVjaCBjaHVua3Mgc2hvcnRlciBtaW5fc3BlZWNoX2R1cmF0aW9uX21zIGFyZSB0aHJvd24gb3V0LgogICAgICAgIDpwYXJhbSBtYXhfc3BlZWNoX2R1cmF0aW9uX3M6ICAgTWF4aW11bSBkdXJhdGlvbiBvZiBzcGVlY2ggY2h1bmtzIGluIHNlY29uZHMuIENodW5rcyBsb25nZXIgdGhhbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYG1heF9zcGVlY2hfZHVyYXRpb25fc2Agd2lsbCBiZSBzcGxpdCBhdCB0aGUgdGltZXN0YW1wIG9mIHRoZSBsYXN0IHNpbGVuY2UgdGhhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdHMgbW9yZSB0aGFuIDEwMG1zIChpZiBhbnkpLCB0byBwcmV2ZW50IGFnZ3Jlc3NpdmUgY3V0dGluZy4gT3RoZXJ3aXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhleSB3aWxsIGJlIHNwbGl0IGFnZ3Jlc3NpdmVseSBqdXN0IGJlZm9yZSBtYXhfc3BlZWNoX2R1cmF0aW9uX3MuCiAgICAgICAgOnBhcmFtIG1pbl9zaWxlbmNlX2R1cmF0aW9uX21zOiBJbiB0aGUgZW5kIG9mIGVhY2ggc3BlZWNoIGNodW5rIHdhaXQgZm9yIG1pbl9zaWxlbmNlX2R1cmF0aW9uX21zIGJlZm9yZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwYXJhdGluZyBpdC4KICAgICAgICA6cGFyYW0gd2luZG93X3NpemVfc2FtcGxlczogICAgIEF1ZGlvIGNodW5rcyBvZiB3aW5kb3dfc2l6ZV9zYW1wbGVzIHNpemUgYXJlIGZlZCB0byB0aGUgc2lsZXJvIFZBRCBtb2RlbC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdBUk5JTkchIFNpbGVybyBWQUQgbW9kZWxzIHdlcmUgdHJhaW5lZCB1c2luZyA1MTIsIDEwMjQsIDE1MzYgc2FtcGxlcyBmb3IgMTYwMDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZSByYXRlIGFuZCAyNTYsIDUxMiwgNzY4IHNhbXBsZXMgZm9yIDgwMDAgc2FtcGxlIHJhdGUuIFZhbHVlcyBvdGhlciB0aGFuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVzZSBtYXkgYWZmZWN0IG1vZGVsIHBlcmZvcm1hbmNlIQogICAgICAgIDpwYXJhbSBzcGVlY2hfcGFkX21zOiAgICAgICAgICAgRmluYWwgc3BlZWNoIGNodW5rcyBhcmUgcGFkZGVkIGJ5IHNwZWVjaF9wYWRfbXMgZWFjaCBzaWRlLgogICAgICAgIDpwYXJhbSByZXR1cm5fc2Vjb25kczogICAgICAgICAgV2hldGhlciByZXR1cm4gdGltZXN0YW1wcyBpbiBzZWNvbmRzLiBGYWxzZSBtZWFucyB0byByZXR1cm4gdGltZXN0YW1wcyBpbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlcyAoZGVmYXVsdCAtIEZhbHNlKS4KICAgICAgICA6cGFyYW0gcGVyX2NoYW5uZWw6ICAgICAgICAgICAgIFdoZXRoZXIgdG8gcmV0dXJuIHRpbWVzdGFtcHMgcGVyIGNoYW5uZWwgKGRlZmF1bHQgLSBGYWxzZSkuIFRoaXMgd2lsbCBydW4gVkFECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbiBlYWNoIGNoYW5uZWwgc2VwYXJhdGVseSBhbmQgcmV0dXJuIGEgbGlzdCBvZiB0aW1lc3RhbXBzIHBlciBjaGFubmVsLgogICAgICAgICIiIgogICAgICAgICMgU3RvcmUgY29uZmlndXJhdGlvbnM6CiAgICAgICAgc2VsZi5fdXNlX29ubnggPSB1c2Vfb25ueAogICAgICAgIHNlbGYuX2ZvcmNlX29ubnhfY3B1ID0gZm9yY2Vfb25ueF9jcHUKICAgICAgICBzZWxmLl90aHJlc2hvbGQgPSB0aHJlc2hvbGQKICAgICAgICBzZWxmLl9zYW1wbGluZ19yYXRlID0gc2FtcGxpbmdfcmF0ZQogICAgICAgIHNlbGYuX21pbl9zcGVlY2hfZHVyYXRpb25fbXMgPSBtaW5fc3BlZWNoX2R1cmF0aW9uX21zCiAgICAgICAgc2VsZi5fbWF4X3NwZWVjaF9kdXJhdGlvbl9zID0gbWF4X3NwZWVjaF9kdXJhdGlvbl9zCiAgICAgICAgc2VsZi5fbWluX3NpbGVuY2VfZHVyYXRpb25fbXMgPSBtaW5fc2lsZW5jZV9kdXJhdGlvbl9tcwogICAgICAgIHNlbGYuX3dpbmRvd19zaXplX3NhbXBsZXMgPSB3aW5kb3dfc2l6ZV9zYW1wbGVzCiAgICAgICAgc2VsZi5fc3BlZWNoX3BhZF9tcyA9IHNwZWVjaF9wYWRfbXMKICAgICAgICBzZWxmLl9yZXR1cm5fc2Vjb25kcyA9IHJldHVybl9zZWNvbmRzCiAgICAgICAgc2VsZi5fcGVyX2NoYW5uZWwgPSBwZXJfY2hhbm5lbAoKICAgICAgICAjIFByZXBhcmUgdGhlIG1vZGVsIHZhcmlhYmxlcwogICAgICAgIHNlbGYuX21vZGVsOiB0b3JjaC5Nb2R1bGUgPSBOb25lCiAgICAgICAgc2VsZi5fZ2V0X3NwZWVjaF90aW1lc3RhbXBzOiBGdW5jdGlvblR5cGUgPSBOb25lCgogICAgZGVmIGxvYWQoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgTG9hZCB0aGUgVkFEIG1vZGVsLgogICAgICAgICIiIgogICAgICAgIG1vZGVsLCB1dGlscyA9IHRvcmNoLmh1Yi5sb2FkKAogICAgICAgICAgICByZXBvX29yX2Rpcj0ic25ha2VyczQvc2lsZXJvLXZhZCIsCiAgICAgICAgICAgIG1vZGVsPSJzaWxlcm9fdmFkIiwKICAgICAgICAgICAgZm9yY2VfcmVsb2FkPVRydWUsCiAgICAgICAgICAgIG9ubng9c2VsZi5fdXNlX29ubngsCiAgICAgICAgICAgIGZvcmNlX29ubnhfY3B1PXNlbGYuX2ZvcmNlX29ubnhfY3B1LAogICAgICAgICkKICAgICAgICBzZWxmLl9tb2RlbCA9IG1vZGVsCiAgICAgICAgKAogICAgICAgICAgICBzZWxmLl9nZXRfc3BlZWNoX3RpbWVzdGFtcHMsCiAgICAgICAgICAgIF8sICAjIHNhdmVfYXVkaW8sCiAgICAgICAgICAgIF8sICAjIHJlYWRfYXVkaW8sCiAgICAgICAgICAgIF8sICAjIFZBREl0ZXJhdG9yLAogICAgICAgICAgICBfLCAgIyBjb2xsZWN0X2NodW5rcwogICAgICAgICkgPSB1dGlscwoKICAgIGRlZiBkZXRlY3Rfdm9pY2UoCiAgICAgICAgc2VsZiwKICAgICAgICBhdWRpb19maWxlOiBQYXRoLAogICAgKSAtPiBVbmlvbltMaXN0W0RpY3Rbc3RyLCBpbnRdXSwgTGlzdFtMaXN0W0RpY3Rbc3RyLCBpbnRdXV1dOgogICAgICAgICIiIgogICAgICAgIEluZmVyIHRoZSBhdWRpbyB0aHJvdWdoIHRoZSBWQUQgbW9kZWwgYW5kIHJldHVybiB0aGUgc3BlZWNoIHRpbWVzdGFtcHMuCgogICAgICAgIDpwYXJhbSBhdWRpb19maWxlOiBUaGUgYXVkaW8gZmlsZSB0byBpbmZlci4KCiAgICAgICAgOnJldHVybnM6IFRoZSBzcGVlY2ggdGltZXN0YW1wcyBpbiB0aGUgYXVkaW8uIEEgbGlzdCBvZiB0aW1lc3RhbXBzIHdoZXJlIGVhY2ggdGltZXN0YW1wIGlzIGEgZGljdGlvbmFyeSB3aXRoIHRoZQogICAgICAgICAgICAgICAgIGZvbGxvd2luZyBrZXlzOgoKICAgICAgICAgICAgICAgICAqICJzdGFydCI6IFRoZSBzdGFydCBzYW1wbGUgaW5kZXggb2YgdGhlIHNwZWVjaCBpbiB0aGUgYXVkaW8uCiAgICAgICAgICAgICAgICAgKiAiZW5kIjogICBUaGUgZW5kIHNhbXBsZSBpbmRleCBvZiB0aGUgc3BlZWNoIGluIHRoZSBhdWRpby4KCiAgICAgICAgICAgICAgICAgSWYgYHBlcl9jaGFubmVsYCBpcyBUcnVlLCBhIGxpc3Qgb2YgdGltZXN0YW1wcyBwZXIgY2hhbm5lbCB3aWxsIGJlIHJldHVybmVkLgogICAgICAgICIiIgogICAgICAgICMgQ2FzdCB0byBhIG51bXB5IGFycmF5OgogICAgICAgIGF1ZGlvID0gc2VsZi5fcmVhZF9hdWRpbyhhdWRpb19maWxlKQoKICAgICAgICAjIERldGVjdCBzcGVlY2g6CiAgICAgICAgaWYgbm90IHNlbGYuX3Blcl9jaGFubmVsOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X3NwZWVjaF90aW1lc3RhbXBzKAogICAgICAgICAgICAgICAgYXVkaW8sCiAgICAgICAgICAgICAgICBzZWxmLl9tb2RlbCwKICAgICAgICAgICAgICAgIHRocmVzaG9sZD1zZWxmLl90aHJlc2hvbGQsCiAgICAgICAgICAgICAgICBtaW5fc3BlZWNoX2R1cmF0aW9uX21zPXNlbGYuX21pbl9zcGVlY2hfZHVyYXRpb25fbXMsCiAgICAgICAgICAgICAgICBtYXhfc3BlZWNoX2R1cmF0aW9uX3M9c2VsZi5fbWF4X3NwZWVjaF9kdXJhdGlvbl9zLAogICAgICAgICAgICAgICAgbWluX3NpbGVuY2VfZHVyYXRpb25fbXM9c2VsZi5fbWluX3NpbGVuY2VfZHVyYXRpb25fbXMsCiAgICAgICAgICAgICAgICBzcGVlY2hfcGFkX21zPXNlbGYuX3NwZWVjaF9wYWRfbXMsCiAgICAgICAgICAgICAgICBzYW1wbGluZ19yYXRlPXNlbGYuX3NhbXBsaW5nX3JhdGUsCiAgICAgICAgICAgICAgICB3aW5kb3dfc2l6ZV9zYW1wbGVzPXNlbGYuX3dpbmRvd19zaXplX3NhbXBsZXMsCiAgICAgICAgICAgICAgICByZXR1cm5fc2Vjb25kcz1zZWxmLl9yZXR1cm5fc2Vjb25kcywKICAgICAgICAgICAgKQoKICAgICAgICAjIFBlciBjaGFubmVsOgogICAgICAgIHNwZWVjaF90aW1lc3RhbXBzID0gW10KICAgICAgICBmb3IgY2hhbm5lbCBpbiBhdWRpbzoKICAgICAgICAgICAgc3BlZWNoX3RpbWVzdGFtcHMuYXBwZW5kKAogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X3NwZWVjaF90aW1lc3RhbXBzKAogICAgICAgICAgICAgICAgICAgIGNoYW5uZWwsCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fbW9kZWwsCiAgICAgICAgICAgICAgICAgICAgdGhyZXNob2xkPXNlbGYuX3RocmVzaG9sZCwKICAgICAgICAgICAgICAgICAgICBtaW5fc3BlZWNoX2R1cmF0aW9uX21zPXNlbGYuX21pbl9zcGVlY2hfZHVyYXRpb25fbXMsCiAgICAgICAgICAgICAgICAgICAgbWF4X3NwZWVjaF9kdXJhdGlvbl9zPXNlbGYuX21heF9zcGVlY2hfZHVyYXRpb25fcywKICAgICAgICAgICAgICAgICAgICBtaW5fc2lsZW5jZV9kdXJhdGlvbl9tcz1zZWxmLl9taW5fc2lsZW5jZV9kdXJhdGlvbl9tcywKICAgICAgICAgICAgICAgICAgICBzcGVlY2hfcGFkX21zPXNlbGYuX3NwZWVjaF9wYWRfbXMsCiAgICAgICAgICAgICAgICAgICAgc2FtcGxpbmdfcmF0ZT1zZWxmLl9zYW1wbGluZ19yYXRlLAogICAgICAgICAgICAgICAgICAgIHdpbmRvd19zaXplX3NhbXBsZXM9c2VsZi5fd2luZG93X3NpemVfc2FtcGxlcywKICAgICAgICAgICAgICAgICAgICByZXR1cm5fc2Vjb25kcz1zZWxmLl9yZXR1cm5fc2Vjb25kcywKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQoKICAgICAgICByZXR1cm4gc3BlZWNoX3RpbWVzdGFtcHMKCiAgICBkZWYgX3JlYWRfYXVkaW8oCiAgICAgICAgc2VsZiwKICAgICAgICBwYXRoOiBzdHIsCiAgICApIC0+IHRvcmNoLlRlbnNvcjoKICAgICAgICAiIiIKICAgICAgICBSZWFkIHRoZSBhdWRpbyBmcm9tIHRoZSBnaXZlbiBwYXRoIGFuZCByZXR1cm4gaXQgYXMgYSB0ZW5zb3IuCgogICAgICAgIDpwYXJhbSBwYXRoOiBUaGUgcGF0aCB0byB0aGUgYXVkaW8gZmlsZS4KCiAgICAgICAgOnJldHVybnM6IFRoZSBhdWRpbyBhcyBhIHRlbnNvci4KICAgICAgICAiIiIKICAgICAgICAjIFJlYWQgdGhlIGF1ZGlvOgogICAgICAgIGF1ZGlvLCBzYW1wbGluZ19yYXRlID0gdG9yY2hhdWRpby5sb2FkKHBhdGgpCgogICAgICAgICMgQ2hlY2sgaWYgdGhlIGF1ZGlvIGlzIHN0ZXJlbyBhbmQgaWYgc28sIGNvbnZlcnQgaXQgdG8gbW9ubyAob25seSBpZiBub3QgcGVyIGNoYW5uZWwpOgogICAgICAgIGlmIGF1ZGlvLnNpemUoMCkgPiAxIGFuZCBub3Qgc2VsZi5fcGVyX2NoYW5uZWw6CiAgICAgICAgICAgIGF1ZGlvID0gYXVkaW8ubWVhbihkaW09MCwga2VlcGRpbT1UcnVlKQoKICAgICAgICAjIFJlc2FtcGxlIHRoZSBhdWRpbyBpZiBuZWVkZWQ6CiAgICAgICAgaWYgc2FtcGxpbmdfcmF0ZSAhPSBzZWxmLl9zYW1wbGluZ19yYXRlOgogICAgICAgICAgICB0cmFuc2Zvcm0gPSB0b3JjaGF1ZGlvLnRyYW5zZm9ybXMuUmVzYW1wbGUoCiAgICAgICAgICAgICAgICBvcmlnX2ZyZXE9c2FtcGxpbmdfcmF0ZSwgbmV3X2ZyZXE9c2VsZi5fc2FtcGxpbmdfcmF0ZQogICAgICAgICAgICApCiAgICAgICAgICAgIGF1ZGlvID0gdHJhbnNmb3JtKGF1ZGlvKQoKICAgICAgICAjIFJldHVybiB0aGUgYXVkaW8gKHNxdWVlemUgaWYgbm90IHBlciBjaGFubmVsKToKICAgICAgICByZXR1cm4gYXVkaW8gaWYgc2VsZi5fcGVyX2NoYW5uZWwgZWxzZSBhdWRpby5zcXVlZXplKDApCgoKIzogVGhlIHZhbHVlIHRvIHNlbmQgaW50byBtdWx0aXByb2Nlc3NpbmcgcXVldWVzIHRvIHN0b3AgdGhlIHByb2Nlc3M6Cl9NVUxUSVBST0NFU1NJTkdfU1RPUF9NQVJLID0gIlNUT1AiCgoKZGVmIF9tdWx0aXByb2Nlc3NpbmdfY29tcGxldGVfdGFza3MoCiAgICB2YWRfaW5pdF9rd2FyZ3M6IGRpY3QsIHRhc2tzX3F1ZXVlOiBRdWV1ZSwgcmVzdWx0c19xdWV1ZTogUXVldWUKKToKICAgICIiIgogICAgQ29tcGxldGUgdGhlIHRhc2tzIGluIHRoZSBnaXZlbiBxdWV1ZSBhbmQgcHV0IHRoZSByZXN1bHRzIGluIHRoZSBnaXZlbiByZXN1bHRzIHF1ZXVlLiBUaGUgZnVuY3Rpb24gd2lsbCBzdG9wIHdoZW4KICAgIHRoZSBnaXZlbiB0YXNrcyBxdWV1ZSB3aWxsIHJlY2VpdmUgdGhlIHN0b3AgbWFyay4gSXQgaXMgYWltZWQgdG8gYmUgdXNlZCB3aXRoIG11bHRpcHJvY2Vzc2luZyBhcyBhIHByb2Nlc3MuCgogICAgOnBhcmFtIHZhZF9pbml0X2t3YXJnczogVGhlIFZBRCBpbml0aWFsaXphdGlvbiBrd2FyZ3MuCiAgICA6cGFyYW0gdGFza3NfcXVldWU6ICAgICBBIHF1ZXVlIHRvIGdldCB0aGUgdGFza3MgZnJvbS4KICAgIDpwYXJhbSByZXN1bHRzX3F1ZXVlOiAgIEEgcXVldWUgdG8gcHV0IHRoZSByZXN1bHRzIGluLgogICAgIiIiCiAgICAjIEluaXRpYWxpemUgYW5kIGxvYWQgdGhlIFZBRDoKICAgIHZhZCA9IFZvaWNlQWN0aXZpdHlEZXRlY3RvcigqKnZhZF9pbml0X2t3YXJncykKICAgIHZhZC5sb2FkKCkKCiAgICAjIFN0YXJ0IGxpc3RlbmluZyB0byB0aGUgdGFza3MgcXVldWU6CiAgICB3aGlsZSBUcnVlOgogICAgICAgICMgR2V0IHRoZSB0YXNrOgogICAgICAgIHRhc2s6IEJhc2VUYXNrID0gdGFza3NfcXVldWUuZ2V0KCkKICAgICAgICBpZiB0YXNrID09IF9NVUxUSVBST0NFU1NJTkdfU1RPUF9NQVJLOgogICAgICAgICAgICBicmVhawogICAgICAgIHRyeToKICAgICAgICAgICAgIyBSdW4gdGhlIGZpbGUgdGhyb3VnaCB0aGUgVkFEOgogICAgICAgICAgICBzcGVlY2hfdGltZXN0YW1wcyA9IHZhZC5kZXRlY3Rfdm9pY2UoYXVkaW9fZmlsZT10YXNrLmF1ZGlvX2ZpbGUpCiAgICAgICAgICAgICMgQ29tcGxldGUgdGhlIHRhc2s6CiAgICAgICAgICAgIHRhc2suZG9fdGFzayhzcGVlY2hfdGltZXN0YW1wcz1zcGVlY2hfdGltZXN0YW1wcykKICAgICAgICAgICAgIyBDb2xsZWN0IHRoZSByZXN1bHQ6CiAgICAgICAgICAgIHJlc3VsdHNfcXVldWUucHV0KChGYWxzZSwgdGFzay5nZXRfcmVzdWx0KCkpKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjZXB0aW9uOgogICAgICAgICAgICAjIENvbGxlY3QgdGhlIGVycm9yOgogICAgICAgICAgICByZXN1bHRzX3F1ZXVlLnB1dCgoVHJ1ZSwgKHRhc2suYXVkaW9fZmlsZS5uYW1lLCBzdHIoZXhjZXB0aW9uKSkpKQoKICAgICMgTWFyayB0aGUgZW5kIG9mIHRoZSB0YXNrczoKICAgIHJlc3VsdHNfcXVldWUucHV0KF9NVUxUSVBST0NFU1NJTkdfU1RPUF9NQVJLKQoKCiMgR2V0IHRoZSBnbG9iYWwgbG9nZ2VyOgpfTE9HR0VSID0gbG9nZ2luZy5nZXRMb2dnZXIoKQoKCmRlZiBkZXRlY3Rfdm9pY2UoCiAgICAjIElucHV0IGt3YXJnczoKICAgIGRhdGFfcGF0aDogVW5pb25bc3RyLCBQYXRoLCBMaXN0W1VuaW9uW3N0ciwgUGF0aF1dXSwKICAgICMgTW9kZWwgbG9hZGluZyBrd2FyZ3M6CiAgICB1c2Vfb25ueDogYm9vbCA9IFRydWUsCiAgICBmb3JjZV9vbm54X2NwdTogYm9vbCA9IFRydWUsCiAgICAjIERldGVjdGlvbiBrd2FyZ3M6CiAgICB0aHJlc2hvbGQ6IGZsb2F0ID0gMC41LAogICAgc2FtcGxpbmdfcmF0ZTogaW50ID0gMTZfMDAwLAogICAgbWluX3NwZWVjaF9kdXJhdGlvbl9tczogaW50ID0gMjUwLAogICAgbWF4X3NwZWVjaF9kdXJhdGlvbl9zOiBmbG9hdCA9IGZsb2F0KCJpbmYiKSwKICAgIG1pbl9zaWxlbmNlX2R1cmF0aW9uX21zOiBpbnQgPSAxMDAsCiAgICB3aW5kb3dfc2l6ZV9zYW1wbGVzOiBpbnQgPSA1MTIsCiAgICBzcGVlY2hfcGFkX21zOiBpbnQgPSAzMCwKICAgIHJldHVybl9zZWNvbmRzOiBib29sID0gRmFsc2UsCiAgICBwZXJfY2hhbm5lbDogYm9vbCA9IEZhbHNlLAogICAgIyBPdGhlciBrd2FyZ3M6CiAgICB1c2VfbXVsdGlwcm9jZXNzaW5nOiBpbnQgPSAwLAogICAgdmVyYm9zZTogYm9vbCA9IEZhbHNlLAopOgogICAgIiIiCiAgICBQZXJmb3JtIHZvaWNlIGFjdGl2aXR5IGRldGVjdGlvbiBvbiBnaXZlbiBhdWRpbyBmaWxlcyB1c2luZyB0aGUgc2lsZXJvIFZBRCBtb2RlbCAtCiAgICBodHRwczovL2dpdGh1Yi5jb20vc25ha2VyczQvc2lsZXJvLXZhZC4gVGhlIGVuZCByZXN1bHQgaXMgYSBkaWN0aW9uYXJ5IHdpdGggdGhlIGZpbGUgbmFtZXMgYXMga2V5cyBhbmQgdGhlaXIKICAgIFZBRCB0aW1lc3RhbXBzIGRpY3Rpb25hcmllcyBhcyB2YWx1ZS4KCiAgICBGb3IgZXhhbXBsZTo6CgogICAgICAgIHsKICAgICAgICAgICAgImZpbGVfMS53YXYiOiBbCiAgICAgICAgICAgICAgICB7InN0YXJ0IjogMCwgImVuZCI6IDE2MDAwfSwKICAgICAgICAgICAgICAgIHsic3RhcnQiOiAxNjAwMCwgImVuZCI6IDMyMDAwfSwKICAgICAgICAgICAgICAgIHsic3RhcnQiOiAzMjAwMCwgImVuZCI6IDQ4MDAwfSwKICAgICAgICAgICAgICAgIC4uLgogICAgICAgICAgICBdLAogICAgICAgICAgICAiZmlsZV8yLndhdiI6IFsKICAgICAgICAgICAgICAgIHsic3RhcnQiOiAwLCAiZW5kIjogMTYwMDB9LAogICAgICAgICAgICAgICAgeyJzdGFydCI6IDE2MDAwLCAiZW5kIjogMzIwMDB9LAogICAgICAgICAgICAgICAgeyJzdGFydCI6IDMyMDAwLCAiZW5kIjogNDgwMDB9LAogICAgICAgICAgICAgICAgLi4uCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIC4uLgogICAgICAgIH0KCgogICAgOnBhcmFtIGRhdGFfcGF0aDogICAgICAgICAgICAgICBUaGUgcGF0aCB0byB0aGUgYXVkaW8gZmlsZXMgdG8gZGlhcml6ZS4gQ2FuIGJlIGEgcGF0aCB0byBhIHNpbmdsZSBmaWxlLCBhIHBhdGggdG8gYQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rvcnkgb3IgYSBsaXN0IG9mIHBhdGhzIHRvIGZpbGVzLgogICAgOnBhcmFtIHVzZV9vbm54OiAgICAgICAgICAgICAgICBXaGV0aGVyIHRvIHVzZSBPTk5YIGZvciBpbmZlcmVuY2UuIERlZmF1bHQgaXMgVHJ1ZS4KICAgIDpwYXJhbSBmb3JjZV9vbm54X2NwdTogICAgICAgICAgV2hldGhlciB0byBmb3JjZSBPTk5YIHRvIHVzZSBDUFUgZm9yIGluZmVyZW5jZS4gRGVmYXVsdCBpcyBUcnVlLgogICAgOnBhcmFtIHRocmVzaG9sZDogICAgICAgICAgICAgICBTcGVlY2ggdGhyZXNob2xkLiBTaWxlcm8gVkFEIG91dHB1dHMgc3BlZWNoIHByb2JhYmlsaXRpZXMgZm9yIGVhY2ggYXVkaW8gY2h1bmssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2JhYmlsaXRpZXMgQUJPVkUgdGhpcyB2YWx1ZSBhcmUgY29uc2lkZXJlZCBhcyBTUEVFQ0guIEl0IGlzIGJldHRlciB0byB0dW5lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMgcGFyYW1ldGVyIGZvciBlYWNoIGRhdGFzZXQgc2VwYXJhdGVseSwgYnV0ICJsYXp5IiAwLjUgaXMgcHJldHR5IGdvb2QgZm9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vc3QgZGF0YXNldHMuCiAgICA6cGFyYW0gc2FtcGxpbmdfcmF0ZTogICAgICAgICAgIEN1cnJlbnRseSwgc2lsZXJvIFZBRCBtb2RlbHMgc3VwcG9ydCA4MDAwIGFuZCAxNjAwMCBzYW1wbGUgcmF0ZXMuCiAgICA6cGFyYW0gbWluX3NwZWVjaF9kdXJhdGlvbl9tczogIEZpbmFsIHNwZWVjaCBjaHVua3Mgc2hvcnRlciBtaW5fc3BlZWNoX2R1cmF0aW9uX21zIGFyZSB0aHJvd24gb3V0LgogICAgOnBhcmFtIG1heF9zcGVlY2hfZHVyYXRpb25fczogICBNYXhpbXVtIGR1cmF0aW9uIG9mIHNwZWVjaCBjaHVua3MgaW4gc2Vjb25kcy4gQ2h1bmtzIGxvbmdlciB0aGFuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBtYXhfc3BlZWNoX2R1cmF0aW9uX3NgIHdpbGwgYmUgc3BsaXQgYXQgdGhlIHRpbWVzdGFtcCBvZiB0aGUgbGFzdCBzaWxlbmNlIHRoYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdHMgbW9yZSB0aGFuIDEwMG1zIChpZiBhbnkpLCB0byBwcmV2ZW50IGFnZ3Jlc3NpdmUgY3V0dGluZy4gT3RoZXJ3aXNlLCB0aGV5IHdpbGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUgc3BsaXQgYWdncmVzc2l2ZWx5IGp1c3QgYmVmb3JlIG1heF9zcGVlY2hfZHVyYXRpb25fcy4KICAgIDpwYXJhbSBtaW5fc2lsZW5jZV9kdXJhdGlvbl9tczogSW4gdGhlIGVuZCBvZiBlYWNoIHNwZWVjaCBjaHVuayB3YWl0IGZvciBtaW5fc2lsZW5jZV9kdXJhdGlvbl9tcyBiZWZvcmUgc2VwYXJhdGluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdC4KICAgIDpwYXJhbSB3aW5kb3dfc2l6ZV9zYW1wbGVzOiAgICAgQXVkaW8gY2h1bmtzIG9mIHdpbmRvd19zaXplX3NhbXBsZXMgc2l6ZSBhcmUgZmVkIHRvIHRoZSBzaWxlcm8gVkFEIG1vZGVsLgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV0FSTklORyEgU2lsZXJvIFZBRCBtb2RlbHMgd2VyZSB0cmFpbmVkIHVzaW5nIDUxMiwgMTAyNCwgMTUzNiBzYW1wbGVzIGZvciAxNjAwMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGUgcmF0ZSBhbmQgMjU2LCA1MTIsIDc2OCBzYW1wbGVzIGZvciA4MDAwIHNhbXBsZSByYXRlLiBWYWx1ZXMgb3RoZXIgdGhhbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVzZSBtYXkgYWZmZWN0IG1vZGVsIHBlcmZvcm1hbmNlIQogICAgOnBhcmFtIHNwZWVjaF9wYWRfbXM6ICAgICAgICAgICBGaW5hbCBzcGVlY2ggY2h1bmtzIGFyZSBwYWRkZWQgYnkgc3BlZWNoX3BhZF9tcyBlYWNoIHNpZGUuCiAgICA6cGFyYW0gcmV0dXJuX3NlY29uZHM6ICAgICAgICAgIFdoZXRoZXIgcmV0dXJuIHRpbWVzdGFtcHMgaW4gc2Vjb25kcy4gRmFsc2UgbWVhbnMgdG8gcmV0dXJuIHRpbWVzdGFtcHMgaW4gc2FtcGxlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGVmYXVsdCAtIEZhbHNlKS4KICAgIDpwYXJhbSBwZXJfY2hhbm5lbDogICAgICAgICAgICAgV2hldGhlciB0byByZXR1cm4gdGltZXN0YW1wcyBwZXIgY2hhbm5lbCAoZGVmYXVsdCAtIEZhbHNlKS4gVGhpcyB3aWxsIHJ1biBWQUQgb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFjaCBjaGFubmVsIHNlcGFyYXRlbHkgYW5kIHJldHVybiBhIGxpc3Qgb2YgdGltZXN0YW1wcyBwZXIgY2hhbm5lbC4KICAgIDpwYXJhbSB1c2VfbXVsdGlwcm9jZXNzaW5nOiAgICAgVGhlIG51bWJlciBvZiB3b3JrZXJzIHRvIHVzZSBmb3IgbXVsdGlwcm9jZXNzaW5nLiBJZiAwLCBubyBtdWx0aXByb2Nlc3Npbmcgd2lsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZSB1c2VkLiBEZWZhdWx0IGlzIDAuCiAgICA6cGFyYW0gdmVyYm9zZTogICAgICAgICAgICAgICAgIFZlcmJvc2l0eS4KICAgICIiIgogICAgZ2xvYmFsIF9MT0dHRVIKCiAgICAjIEdldCB0aGUgaW5wdXQgYXVkaW8gZmlsZXMgdG8gdHJhbnNjcmliZToKICAgIGlmIHZlcmJvc2U6CiAgICAgICAgX0xPR0dFUi5pbmZvKCJDb2xsZWN0aW5nIGF1ZGlvIGZpbGVzLiIpCiAgICBhdWRpb19maWxlcyA9IF9nZXRfYXVkaW9fZmlsZXMoZGF0YV9wYXRoPWRhdGFfcGF0aCkKICAgIGlmIHZlcmJvc2U6CiAgICAgICAgX0xPR0dFUi5pbmZvKGYiQ29sbGVjdGVkIHtsZW4oYXVkaW9fZmlsZXMpfSBhdWRpbyBmaWxlcy4iKQoKICAgICMgSW5pdGlhbGl6ZSB0aGUgdHJhbnNjcmlwdGlvbiBwaXBlbGluZToKICAgIHZhZF9pbml0X2t3YXJncyA9IHsKICAgICAgICAidXNlX29ubngiOiB1c2Vfb25ueCwKICAgICAgICAiZm9yY2Vfb25ueF9jcHUiOiBmb3JjZV9vbm54X2NwdSwKICAgICAgICAidGhyZXNob2xkIjogdGhyZXNob2xkLAogICAgICAgICJzYW1wbGluZ19yYXRlIjogc2FtcGxpbmdfcmF0ZSwKICAgICAgICAibWluX3NwZWVjaF9kdXJhdGlvbl9tcyI6IG1pbl9zcGVlY2hfZHVyYXRpb25fbXMsCiAgICAgICAgIm1heF9zcGVlY2hfZHVyYXRpb25fcyI6IG1heF9zcGVlY2hfZHVyYXRpb25fcywKICAgICAgICAibWluX3NpbGVuY2VfZHVyYXRpb25fbXMiOiBtaW5fc2lsZW5jZV9kdXJhdGlvbl9tcywKICAgICAgICAid2luZG93X3NpemVfc2FtcGxlcyI6IHdpbmRvd19zaXplX3NhbXBsZXMsCiAgICAgICAgInNwZWVjaF9wYWRfbXMiOiBzcGVlY2hfcGFkX21zLAogICAgICAgICJyZXR1cm5fc2Vjb25kcyI6IHJldHVybl9zZWNvbmRzLAogICAgICAgICJwZXJfY2hhbm5lbCI6IHBlcl9jaGFubmVsLAogICAgfQoKICAgICMgQ3JlYXRlIHRoZSB0YXNrIGNyZWF0b3I6CiAgICB0YXNrX2NyZWF0b3IgPSBUYXNrQ3JlYXRvcih0YXNrX3R5cGU9QmFzZVRhc2spCgogICAgIyBSdW4gdGhlIHRyYW5zY3JpcHRpb246CiAgICBpZiB1c2VfbXVsdGlwcm9jZXNzaW5nOgogICAgICAgIHJlc3VsdHMgPSBfcGFyYWxsZWxfcnVuKAogICAgICAgICAgICBuX3dvcmtlcnM9dXNlX211bHRpcHJvY2Vzc2luZywKICAgICAgICAgICAgYXVkaW9fZmlsZXM9YXVkaW9fZmlsZXMsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJEZXRlY3Rpbmcgdm9pY2UiLAogICAgICAgICAgICB2YWRfaW5pdF9rd2FyZ3M9dmFkX2luaXRfa3dhcmdzLAogICAgICAgICAgICB0YXNrX2NyZWF0b3I9dGFza19jcmVhdG9yLAogICAgICAgICAgICB2ZXJib3NlPXZlcmJvc2UsCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICByZXN1bHRzID0gX3J1bigKICAgICAgICAgICAgYXVkaW9fZmlsZXM9YXVkaW9fZmlsZXMsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJEZXRlY3Rpbmcgdm9pY2UiLAogICAgICAgICAgICB2YWRfaW5pdF9rd2FyZ3M9dmFkX2luaXRfa3dhcmdzLAogICAgICAgICAgICB0YXNrX2NyZWF0b3I9dGFza19jcmVhdG9yLAogICAgICAgICAgICB2ZXJib3NlPXZlcmJvc2UsCiAgICAgICAgKQoKICAgICMgUHJvY2VzcyB0aGUgcmVzdWx0czoKICAgIHJldHVybiBfcHJvY2Vzc19yZXN1bHRzKHJlc3VsdHM9cmVzdWx0cywgdmVyYm9zZT12ZXJib3NlKQoKCmRlZiBkaWFyaXplKAogICAgIyBJbnB1dCAvIE91dHB1dCBrd2FyZ3M6CiAgICBkYXRhX3BhdGg6IFVuaW9uW3N0ciwgUGF0aCwgTGlzdFtVbmlvbltzdHIsIFBhdGhdXV0sCiAgICAjIE1vZGVsIGxvYWRpbmcga3dhcmdzOgogICAgdXNlX29ubng6IGJvb2wgPSBUcnVlLAogICAgZm9yY2Vfb25ueF9jcHU6IGJvb2wgPSBUcnVlLAogICAgIyBEZXRlY3Rpb24ga3dhcmdzOgogICAgdGhyZXNob2xkOiBmbG9hdCA9IDAuNSwKICAgIHNhbXBsaW5nX3JhdGU6IGludCA9IDE2XzAwMCwKICAgIG1pbl9zcGVlY2hfZHVyYXRpb25fbXM6IGludCA9IDI1MCwKICAgIG1heF9zcGVlY2hfZHVyYXRpb25fczogZmxvYXQgPSBmbG9hdCgiaW5mIiksCiAgICBtaW5fc2lsZW5jZV9kdXJhdGlvbl9tczogaW50ID0gMTAwLAogICAgd2luZG93X3NpemVfc2FtcGxlczogaW50ID0gNTEyLAogICAgc3BlZWNoX3BhZF9tczogaW50ID0gMzAsCiAgICAjIERpYXJpemF0aW9uIGt3YXJnczoKICAgIHNwZWFrZXJfbGFiZWxzOiBMaXN0W3N0cl0gPSBOb25lLAogICAgIyBPdGhlciBrd2FyZ3M6CiAgICB1c2VfbXVsdGlwcm9jZXNzaW5nOiBpbnQgPSAwLAogICAgdmVyYm9zZTogYm9vbCA9IEZhbHNlLAopOgogICAgIiIiCiAgICBQZXJmb3JtIHNwZWVjaCBkaWFyaXphdGlvbiBvbiBnaXZlbiBhdWRpbyBmaWxlcyB1c2luZyB0aGUgc2lsZXJvIFZBRCBtb2RlbCAtIGh0dHBzOi8vZ2l0aHViLmNvbS9zbmFrZXJzNC9zaWxlcm8tdmFkLgogICAgVGhlIHNwZWVjaCBkaWFyaXphdGlvbiBpcyBwZXJmb3JtZWQgcGVyIGNoYW5uZWwgc28gdGhhdCBlYWNoIGNoYW5uZWwgaW4gdGhlIGF1ZGlvIGJlbG9uZyB0byBhIGRpZmZlcmVudCBzcGVha2VyLiBUaGUKICAgIGVuZCByZXN1bHQgaXMgYSBkaWN0aW9uYXJ5IHdpdGggdGhlIGZpbGUgbmFtZXMgYXMga2V5cyBhbmQgdGhlaXIgZGlhcml6YXRpb24gYXMgdmFsdWUuIEEgZGlhcml6YXRpb24gaXMgYSBsaXN0CiAgICBvZiB0dXBsZXM6IChzdGFydCwgZW5kLCBzcGVha2VyX2xhYmVsKS4KCiAgICBGb3IgZXhhbXBsZTo6CgogICAgICAgIHsKICAgICAgICAgICAgImZpbGVfMS53YXYiOiBbCiAgICAgICAgICAgICAgICAoMC4wLCAxLjAsICJzcGVha2VyXzAiKSwKICAgICAgICAgICAgICAgICgxLjAsIDIuMCwgInNwZWFrZXJfMSIpLAogICAgICAgICAgICAgICAgKDIuMCwgMy4wLCAic3BlYWtlcl8wIiksCiAgICAgICAgICAgICAgICAuLi4KICAgICAgICAgICAgXSwKICAgICAgICAgICAgImZpbGVfMi53YXYiOiBbCiAgICAgICAgICAgICAgICAoMC4wLCAxLjAsICJzcGVha2VyXzAiKSwKICAgICAgICAgICAgICAgICgxLjAsIDIuMCwgInNwZWFrZXJfMSIpLAogICAgICAgICAgICAgICAgKDIuMCwgMy4wLCAic3BlYWtlcl8wIiksCiAgICAgICAgICAgICAgICAuLi4KICAgICAgICAgICAgXSwKICAgICAgICAgICAgLi4uCiAgICAgICAgfQoKCiAgICA6cGFyYW0gZGF0YV9wYXRoOiAgICAgICAgICAgICAgIFRoZSBwYXRoIHRvIHRoZSBhdWRpbyBmaWxlcyB0byBkaWFyaXplLiBDYW4gYmUgYSBwYXRoIHRvIGEgc2luZ2xlIGZpbGUsIGEgcGF0aCB0byBhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdG9yeSBvciBhIGxpc3Qgb2YgcGF0aHMgdG8gZmlsZXMuCiAgICA6cGFyYW0gdXNlX29ubng6ICAgICAgICAgICAgICAgIFdoZXRoZXIgdG8gdXNlIE9OTlggZm9yIGluZmVyZW5jZS4gRGVmYXVsdCBpcyBUcnVlLgogICAgOnBhcmFtIGZvcmNlX29ubnhfY3B1OiAgICAgICAgICBXaGV0aGVyIHRvIGZvcmNlIE9OTlggdG8gdXNlIENQVSBmb3IgaW5mZXJlbmNlLiBEZWZhdWx0IGlzIFRydWUuCiAgICA6cGFyYW0gdGhyZXNob2xkOiAgICAgICAgICAgICAgIFNwZWVjaCB0aHJlc2hvbGQuIFNpbGVybyBWQUQgb3V0cHV0cyBzcGVlY2ggcHJvYmFiaWxpdGllcyBmb3IgZWFjaCBhdWRpbyBjaHVuaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvYmFiaWxpdGllcyBBQk9WRSB0aGlzIHZhbHVlIGFyZSBjb25zaWRlcmVkIGFzIFNQRUVDSC4gSXQgaXMgYmV0dGVyIHRvIHR1bmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyBwYXJhbWV0ZXIgZm9yIGVhY2ggZGF0YXNldCBzZXBhcmF0ZWx5LCBidXQgImxhenkiIDAuNSBpcyBwcmV0dHkgZ29vZCBmb3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9zdCBkYXRhc2V0cy4KICAgIDpwYXJhbSBzYW1wbGluZ19yYXRlOiAgICAgICAgICAgQ3VycmVudGx5LCBzaWxlcm8gVkFEIG1vZGVscyBzdXBwb3J0IDgwMDAgYW5kIDE2MDAwIHNhbXBsZSByYXRlcy4KICAgIDpwYXJhbSBtaW5fc3BlZWNoX2R1cmF0aW9uX21zOiAgRmluYWwgc3BlZWNoIGNodW5rcyBzaG9ydGVyIG1pbl9zcGVlY2hfZHVyYXRpb25fbXMgYXJlIHRocm93biBvdXQuCiAgICA6cGFyYW0gbWF4X3NwZWVjaF9kdXJhdGlvbl9zOiAgIE1heGltdW0gZHVyYXRpb24gb2Ygc3BlZWNoIGNodW5rcyBpbiBzZWNvbmRzLiBDaHVua3MgbG9uZ2VyIHRoYW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYG1heF9zcGVlY2hfZHVyYXRpb25fc2Agd2lsbCBiZSBzcGxpdCBhdCB0aGUgdGltZXN0YW1wIG9mIHRoZSBsYXN0IHNpbGVuY2UgdGhhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0cyBtb3JlIHRoYW4gMTAwbXMgKGlmIGFueSksIHRvIHByZXZlbnQgYWdncmVzc2l2ZSBjdXR0aW5nLiBPdGhlcndpc2UsIHRoZXkgd2lsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZSBzcGxpdCBhZ2dyZXNzaXZlbHkganVzdCBiZWZvcmUgbWF4X3NwZWVjaF9kdXJhdGlvbl9zLgogICAgOnBhcmFtIG1pbl9zaWxlbmNlX2R1cmF0aW9uX21zOiBJbiB0aGUgZW5kIG9mIGVhY2ggc3BlZWNoIGNodW5rIHdhaXQgZm9yIG1pbl9zaWxlbmNlX2R1cmF0aW9uX21zIGJlZm9yZSBzZXBhcmF0aW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0LgogICAgOnBhcmFtIHdpbmRvd19zaXplX3NhbXBsZXM6ICAgICBBdWRpbyBjaHVua3Mgb2Ygd2luZG93X3NpemVfc2FtcGxlcyBzaXplIGFyZSBmZWQgdG8gdGhlIHNpbGVybyBWQUQgbW9kZWwuCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXQVJOSU5HISBTaWxlcm8gVkFEIG1vZGVscyB3ZXJlIHRyYWluZWQgdXNpbmcgNTEyLCAxMDI0LCAxNTM2IHNhbXBsZXMgZm9yIDE2MDAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZSByYXRlIGFuZCAyNTYsIDUxMiwgNzY4IHNhbXBsZXMgZm9yIDgwMDAgc2FtcGxlIHJhdGUuIFZhbHVlcyBvdGhlciB0aGFuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZXNlIG1heSBhZmZlY3QgbW9kZWwgcGVyZm9ybWFuY2UhCiAgICA6cGFyYW0gc3BlZWNoX3BhZF9tczogICAgICAgICAgIEZpbmFsIHNwZWVjaCBjaHVua3MgYXJlIHBhZGRlZCBieSBzcGVlY2hfcGFkX21zIGVhY2ggc2lkZS4KICAgIDpwYXJhbSBzcGVha2VyX2xhYmVsczogICAgICAgICAgVGhlIHNwZWFrZXIgbGFiZWxzIHRvIHVzZSBmb3IgdGhlIGRpYXJpemF0aW9uLiBJZiBub3QgZ2l2ZW4sIHRoZSBzcGVha2VycyB3aWxsIGJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVkICJzcGVha2VyXzAiLCAic3BlYWtlcl8xIiwgZXRjLgogICAgOnBhcmFtIHVzZV9tdWx0aXByb2Nlc3Npbmc6ICAgICBUaGUgbnVtYmVyIG9mIHdvcmtlcnMgdG8gdXNlIGZvciBtdWx0aXByb2Nlc3NpbmcuIElmIDAsIG5vIG11bHRpcHJvY2Vzc2luZyB3aWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlIHVzZWQuIERlZmF1bHQgaXMgMC4KICAgIDpwYXJhbSB2ZXJib3NlOiAgICAgICAgICAgICAgICAgVmVyYm9zaXR5LgogICAgIiIiCiAgICBnbG9iYWwgX0xPR0dFUgoKICAgICMgR2V0IHRoZSBpbnB1dCBhdWRpbyBmaWxlcyB0byB0cmFuc2NyaWJlOgogICAgaWYgdmVyYm9zZToKICAgICAgICBfTE9HR0VSLmluZm8oIkNvbGxlY3RpbmcgYXVkaW8gZmlsZXMuIikKICAgIGF1ZGlvX2ZpbGVzID0gX2dldF9hdWRpb19maWxlcyhkYXRhX3BhdGg9ZGF0YV9wYXRoKQogICAgaWYgdmVyYm9zZToKICAgICAgICBfTE9HR0VSLmluZm8oZiJDb2xsZWN0ZWQge2xlbihhdWRpb19maWxlcyl9IGF1ZGlvIGZpbGVzLiIpCgogICAgIyBJbml0aWFsaXplIHRoZSB0cmFuc2NyaXB0aW9uIHBpcGVsaW5lOgogICAgdmFkX2luaXRfa3dhcmdzID0gewogICAgICAgICJ1c2Vfb25ueCI6IHVzZV9vbm54LAogICAgICAgICJmb3JjZV9vbm54X2NwdSI6IGZvcmNlX29ubnhfY3B1LAogICAgICAgICJ0aHJlc2hvbGQiOiB0aHJlc2hvbGQsCiAgICAgICAgInNhbXBsaW5nX3JhdGUiOiBzYW1wbGluZ19yYXRlLAogICAgICAgICJtaW5fc3BlZWNoX2R1cmF0aW9uX21zIjogbWluX3NwZWVjaF9kdXJhdGlvbl9tcywKICAgICAgICAibWF4X3NwZWVjaF9kdXJhdGlvbl9zIjogbWF4X3NwZWVjaF9kdXJhdGlvbl9zLAogICAgICAgICJtaW5fc2lsZW5jZV9kdXJhdGlvbl9tcyI6IG1pbl9zaWxlbmNlX2R1cmF0aW9uX21zLAogICAgICAgICJ3aW5kb3dfc2l6ZV9zYW1wbGVzIjogd2luZG93X3NpemVfc2FtcGxlcywKICAgICAgICAic3BlZWNoX3BhZF9tcyI6IHNwZWVjaF9wYWRfbXMsCiAgICAgICAgInJldHVybl9zZWNvbmRzIjogVHJ1ZSwKICAgICAgICAicGVyX2NoYW5uZWwiOiBUcnVlLAogICAgfQoKICAgICMgQ3JlYXRlIHRoZSB0YXNrIGNyZWF0b3I6CiAgICB0YXNrX2NyZWF0b3IgPSBUYXNrQ3JlYXRvcigKICAgICAgICB0YXNrX3R5cGU9U3BlZWNoRGlhcml6YXRpb25UYXNrLCB0YXNrX2t3YXJncz17InNwZWFrZXJfbGFiZWxzIjogc3BlYWtlcl9sYWJlbHN9CiAgICApCgogICAgIyBSdW4gdGhlIHRyYW5zY3JpcHRpb246CiAgICBpZiB1c2VfbXVsdGlwcm9jZXNzaW5nOgogICAgICAgIHJlc3VsdHMgPSBfcGFyYWxsZWxfcnVuKAogICAgICAgICAgICBuX3dvcmtlcnM9dXNlX211bHRpcHJvY2Vzc2luZywKICAgICAgICAgICAgYXVkaW9fZmlsZXM9YXVkaW9fZmlsZXMsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJEaWFyaXppbmciLAogICAgICAgICAgICB2YWRfaW5pdF9rd2FyZ3M9dmFkX2luaXRfa3dhcmdzLAogICAgICAgICAgICB0YXNrX2NyZWF0b3I9dGFza19jcmVhdG9yLAogICAgICAgICAgICB2ZXJib3NlPXZlcmJvc2UsCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICByZXN1bHRzID0gX3J1bigKICAgICAgICAgICAgYXVkaW9fZmlsZXM9YXVkaW9fZmlsZXMsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJEaWFyaXppbmciLAogICAgICAgICAgICB2YWRfaW5pdF9rd2FyZ3M9dmFkX2luaXRfa3dhcmdzLAogICAgICAgICAgICB0YXNrX2NyZWF0b3I9dGFza19jcmVhdG9yLAogICAgICAgICAgICB2ZXJib3NlPXZlcmJvc2UsCiAgICAgICAgKQoKICAgICMgUHJvY2VzcyB0aGUgcmVzdWx0czoKICAgIHJldHVybiBfcHJvY2Vzc19yZXN1bHRzKHJlc3VsdHM9cmVzdWx0cywgdmVyYm9zZT12ZXJib3NlKQoKCmRlZiBfZ2V0X2F1ZGlvX2ZpbGVzKAogICAgZGF0YV9wYXRoOiBVbmlvbltQYXRoLCBzdHIsIGxpc3RdLAopIC0+IExpc3RbUGF0aF06CiAgICAiIiIKICAgIEdldCB0aGUgYXVkaW8gZmlsZXMgZnJvbSB0aGUgZGF0YSBwYXRoLiBJZiBhIHBhdGggdG8gYSBkaXJlY3RvcnkgaXMgZ2l2ZW4sIGFsbCBmaWxlcyBpbiB0aGUgZGlyZWN0b3J5IHdpbGwgYmUKICAgIGNvbGxlY3RlZC4KCiAgICA6cGFyYW0gZGF0YV9wYXRoOiBUaGUgZGF0YSBwYXRoIHRvIGNvbGxlY3QgdGhlIGF1ZGlvIGZpbGVzIGZyb20uCgogICAgOnJldHVybnM6IFRoZSBhdWRpbyBmaWxlcyBsaXN0LgogICAgIiIiCiAgICAjIENoZWNrIGlmIGdpdmVuIGEgbGlzdCBvZiBwYXRoczoKICAgIGlmIGlzaW5zdGFuY2UoZGF0YV9wYXRoLCBsaXN0KToKICAgICAgICBhdWRpb19maWxlcyA9IFtdCiAgICAgICAgZm9yIHBhdGggaW4gZGF0YV9wYXRoOgogICAgICAgICAgICBhdWRpb19maWxlcy5leHRlbmQoX2dldF9hdWRpb19maWxlcyhkYXRhX3BhdGg9cGF0aCkpCiAgICAgICAgcmV0dXJuIGF1ZGlvX2ZpbGVzCgogICAgIyBDaGVjayBpZiBnaXZlbiBhIHNpbmdsZSBzdHJpbmcgcGF0aCB0byBjYXN0IGl0IHRvIGEgYHBhdGhsaWIuUGF0aGA6CiAgICBpZiBpc2luc3RhbmNlKGRhdGFfcGF0aCwgc3RyKToKICAgICAgICBkYXRhX3BhdGggPSBQYXRoKGRhdGFfcGF0aCkuYWJzb2x1dGUoKQoKICAgICMgQ2hlY2sgaWYgdGhlIHBhdGggaXMgb2YgYSBkaXJlY3Rvcnkgb3IgYSBmaWxlOgogICAgaWYgZGF0YV9wYXRoLmlzX2RpcigpOgogICAgICAgICMgR2V0IGFsbCBmaWxlcyBpbnNpZGUgdGhlIGRpcmVjdG9yeToKICAgICAgICBhdWRpb19maWxlcyA9IGxpc3QoZGF0YV9wYXRoLmdsb2IoIiouKiIpKQogICAgZWxpZiBkYXRhX3BhdGguaXNfZmlsZSgpOgogICAgICAgIGF1ZGlvX2ZpbGVzID0gW2RhdGFfcGF0aF0KICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgZiJVbnJlY29nbml6ZWQgZGF0YSBwYXRoLiBUaGUgcGFyYW1ldGVyIGBkYXRhX3BhdGhgIG11c3QgYmUgYSB2YWxpZCBwYXRoIHRvIGVpdGhlciBhIGRpcmVjdG9yeSBwYXRoIG9yIGEgIgogICAgICAgICAgICBmImZpbGUuIEdpdmVuOiB7c3RyKGRhdGFfcGF0aCl9ICIKICAgICAgICApCgogICAgcmV0dXJuIGF1ZGlvX2ZpbGVzCgoKZGVmIF9ydW4oCiAgICBhdWRpb19maWxlczogTGlzdFtQYXRoXSwKICAgIGRlc2NyaXB0aW9uOiBzdHIsCiAgICB2YWRfaW5pdF9rd2FyZ3M6IGRpY3QsCiAgICB0YXNrX2NyZWF0b3I6IFRhc2tDcmVhdG9yLAogICAgdmVyYm9zZTogYm9vbCwKKSAtPiBMaXN0W1R1cGxlW2Jvb2wsIFR1cGxlW3N0ciwgbGlzdF1dXToKICAgICIiIgogICAgTG9hZCBhIFZBRCBhbmQgdXNlIGl0IHRvIGNvbXBsZXRlIHRoZSB0YXNrcyB0aGF0IHdpbGwgYmUgY3JlYXRlZCBvbiB0aGUgcHJvdmlkZWQgZmlsZXMgdXNpbmcgdGhlIGdpdmVuIHRhc2sgY3JlYXRvci4KCiAgICA6cGFyYW0gYXVkaW9fZmlsZXM6ICAgICBUaGUgYXVkaW8gZmlsZXMgdG8gdXNlLgogICAgOnBhcmFtIGRlc2NyaXB0aW9uOiAgICAgVGhlIGRlc2NyaXB0aW9uIHRvIHVzZSBmb3IgdGhlIHByb2dyZXNzIGJhci4KICAgIDpwYXJhbSB2YWRfaW5pdF9rd2FyZ3M6IFRoZSBWQUQgaW5pdGlhbGl6YXRpb24ga2V5d29yZCBhcmd1bWVudHMuCiAgICA6cGFyYW0gdGFza19jcmVhdG9yOiAgICBUaGUgdGFzayBjcmVhdG9yIHRvIHVzZSB0byBjcmVhdGUgdGhlIHRhc2tzLgogICAgOnBhcmFtIHZlcmJvc2U6ICAgICAgICAgVmVyYm9zaXR5LgoKICAgIDpyZXR1cm5zOiBUaGUgY29sbGVjdGVkIHJlc3VsdHMuCiAgICAiIiIKICAgICMgTG9hZCB0aGUgVkFEOgogICAgdmFkID0gVm9pY2VBY3Rpdml0eURldGVjdG9yKCoqdmFkX2luaXRfa3dhcmdzKQogICAgaWYgdmVyYm9zZToKICAgICAgICBfTE9HR0VSLmluZm8oZiJMb2FkaW5nIHRoZSBWQUQgbW9kZWwuIikKICAgIHZhZC5sb2FkKCkKICAgIGlmIHZlcmJvc2U6CiAgICAgICAgX0xPR0dFUi5pbmZvKCJWQUQgbW9kZWwgbG9hZGVkLiIpCgogICAgIyBSdW4gdGhlIFZBRCBvbiB0aGUgYXVkaW8gZmlsZXMgYW5kIGNvbGxlY3QgdGhlIHJlc3VsdHM6CiAgICByZXN1bHRzID0gW10KICAgIGZvciBhdWRpb19maWxlIGluIHRxZG0oCiAgICAgICAgYXVkaW9fZmlsZXMsCiAgICAgICAgZGVzYz1kZXNjcmlwdGlvbiwKICAgICAgICB1bml0PSJmaWxlIiwKICAgICAgICB0b3RhbD1sZW4oYXVkaW9fZmlsZXMpLAogICAgICAgIGRpc2FibGU9bm90IHZlcmJvc2UsCiAgICApOgogICAgICAgIHRyeToKICAgICAgICAgICAgIyBDcmVhdGUgdGhlIHRhc2s6CiAgICAgICAgICAgIHRhc2sgPSB0YXNrX2NyZWF0b3IuY3JlYXRlX3Rhc2soYXVkaW9fZmlsZT1hdWRpb19maWxlKQogICAgICAgICAgICAjIFJ1biB0aGUgZmlsZSB0aHJvdWdoIHRoZSBWQUQ6CiAgICAgICAgICAgIHNwZWVjaF90aW1lc3RhbXBzID0gdmFkLmRldGVjdF92b2ljZShhdWRpb19maWxlPWF1ZGlvX2ZpbGUpCiAgICAgICAgICAgICMgQ29tcGxldGUgdGhlIHRhc2s6CiAgICAgICAgICAgIHRhc2suZG9fdGFzayhzcGVlY2hfdGltZXN0YW1wcz1zcGVlY2hfdGltZXN0YW1wcykKICAgICAgICAgICAgIyBDb2xsZWN0IHRoZSByZXN1bHQ6CiAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKChGYWxzZSwgdGFzay5nZXRfcmVzdWx0KCkpKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjZXB0aW9uOgogICAgICAgICAgICAjIENvbGxlY3QgdGhlIGVycm9yOgogICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgoVHJ1ZSwgKGF1ZGlvX2ZpbGUubmFtZSwgc3RyKGV4Y2VwdGlvbikpKSkKCiAgICByZXR1cm4gcmVzdWx0cwoKCmRlZiBfcGFyYWxsZWxfcnVuKAogICAgbl93b3JrZXJzOiBpbnQsCiAgICBhdWRpb19maWxlczogTGlzdFtQYXRoXSwKICAgIGRlc2NyaXB0aW9uOiBzdHIsCiAgICB2YWRfaW5pdF9rd2FyZ3M6IGRpY3QsCiAgICB0YXNrX2NyZWF0b3I6IFRhc2tDcmVhdG9yLAogICAgdmVyYm9zZTogYm9vbCwKKSAtPiBMaXN0W1R1cGxlW2Jvb2wsIFR1cGxlW3N0ciwgbGlzdF1dXToKICAgICIiIgogICAgUnVuIG11bHRpcGxlIFZBRCB3b3JrZXJzIHdpdGggbXVsdGlwcm9jZXNzaW5nIHRvIGNvbXBsZXRlIHRoZSB0YXNrcyB0aGF0IHdpbGwgYmUgY3JlYXRlZCBvbiB0aGUgcHJvdmlkZWQgZmlsZXMgdXNpbmcKICAgIHRoZSBnaXZlbiB0YXNrIGNyZWF0b3IuCgogICAgOnBhcmFtIG5fd29ya2VyczogICAgICAgVGhlIG51bWJlciBvZiB3b3JrZXJzIHRvIHVzZS4KICAgIDpwYXJhbSBhdWRpb19maWxlczogICAgIFRoZSBhdWRpbyBmaWxlcyB0byB1c2UuCiAgICA6cGFyYW0gZGVzY3JpcHRpb246ICAgICBUaGUgZGVzY3JpcHRpb24gdG8gdXNlIGZvciB0aGUgcHJvZ3Jlc3MgYmFyLgogICAgOnBhcmFtIHZhZF9pbml0X2t3YXJnczogVGhlIFZBRCBpbml0aWFsaXphdGlvbiBrZXl3b3JkIGFyZ3VtZW50cy4KICAgIDpwYXJhbSB0YXNrX2NyZWF0b3I6ICAgIFRoZSB0YXNrIGNyZWF0b3IgdG8gdXNlIHRvIGNyZWF0ZSB0aGUgdGFza3MuCiAgICA6cGFyYW0gdmVyYm9zZTogICAgICAgICBWZXJib3NpdHkuCgogICAgOnJldHVybnM6IFRoZSBjb2xsZWN0ZWQgcmVzdWx0cy4KICAgICIiIgogICAgIyBDaGVjayB0aGUgbnVtYmVyIG9mIHdvcmtlcnM6CiAgICBpZiBuX3dvcmtlcnMgPiBsZW4oYXVkaW9fZmlsZXMpOgogICAgICAgIF9MT0dHRVIud2FybmluZygKICAgICAgICAgICAgZiJUaGUgbnVtYmVyIG9mIHdvcmtlcnMgKHtuX3dvcmtlcnN9KSBpcyBsYXJnZXIgdGhhbiB0aGUgbnVtYmVyIG9mIGF1ZGlvIGZpbGVzICh7bGVuKGF1ZGlvX2ZpbGVzKX0pLiAiCiAgICAgICAgICAgIGYiU2V0dGluZyB0aGUgbnVtYmVyIG9mIHdvcmtlcnMgdG8ge2xlbihhdWRpb19maWxlcyl9LiIKICAgICAgICApCiAgICAgICAgbl93b3JrZXJzID0gbGVuKGF1ZGlvX2ZpbGVzKQoKICAgICMgSW5pdGlhbGl6ZSB0aGUgbXVsdGlwcm9jZXNzaW5nIHF1ZXVlczoKICAgIHRhc2tzX3F1ZXVlID0gUXVldWUobWF4c2l6ZT1uX3dvcmtlcnMgKiAyKQogICAgcmVzdWx0c19xdWV1ZSA9IFF1ZXVlKCkKCiAgICAjIEluaXRpYWxpemUgdGhlIG11bHRpcHJvY2Vzc2luZyBwcm9jZXNzZXM6CiAgICB0YXNrX2NvbXBsZXRpb25fcHJvY2Vzc2VzID0gWwogICAgICAgIFByb2Nlc3MoCiAgICAgICAgICAgIHRhcmdldD1fbXVsdGlwcm9jZXNzaW5nX2NvbXBsZXRlX3Rhc2tzLAogICAgICAgICAgICBrd2FyZ3M9ewogICAgICAgICAgICAgICAgInZhZF9pbml0X2t3YXJncyI6IHZhZF9pbml0X2t3YXJncywKICAgICAgICAgICAgICAgICJ0YXNrc19xdWV1ZSI6IHRhc2tzX3F1ZXVlLAogICAgICAgICAgICAgICAgInJlc3VsdHNfcXVldWUiOiByZXN1bHRzX3F1ZXVlLAogICAgICAgICAgICB9LAogICAgICAgICkKICAgICAgICBmb3IgXyBpbiByYW5nZShuX3dvcmtlcnMpCiAgICBdCgogICAgIyBTdGFydCB0aGUgbXVsdGlwcm9jZXNzaW5nIHByb2Nlc3NlczoKICAgIGlmIHZlcmJvc2U6CiAgICAgICAgX0xPR0dFUi5pbmZvKGYiTG9hZGluZyB0aGUgVkFEIG1vZGVsIChwZXIgcHJvY2VzcykuIikKICAgIGZvciBwIGluIHRhc2tfY29tcGxldGlvbl9wcm9jZXNzZXM6CiAgICAgICAgcC5zdGFydCgpCiAgICBpZiB2ZXJib3NlOgogICAgICAgIF9MT0dHRVIuaW5mbygiVkFEIG1vZGVsIGxvYWRlZC4iKQoKICAgICMgUHV0IHRoZSB0YXNrcyBpbiB0aGUgcXVldWUgKHRoZSBwcm9ncmVzcyBiYXIgaXMgbm90IGFjY3VyYXRlIGFzIGl0IGlzIHVwZGF0aW5nIGJ5IHRoZSBxdWV1ZSB3aGljaCBoYXMgYSBtYXggc2l6ZQogICAgIyBvZiAyKm5fd29ya2VycyBzbyB0aGUgcHJvZ3Jlc3MgYmFyIHdvbid0IGJlIHRvbyBvZmYgLSBiZXR0ZXIgdGhhbiBub3RoaW5nKToKICAgIGZvciBhdWRpb19maWxlIGluIHRxZG0oCiAgICAgICAgYXVkaW9fZmlsZXMsCiAgICAgICAgZGVzYz1kZXNjcmlwdGlvbiwKICAgICAgICB1bml0PSJmaWxlIiwKICAgICAgICB0b3RhbD1sZW4oYXVkaW9fZmlsZXMpLAogICAgICAgIGRpc2FibGU9bm90IHZlcmJvc2UsCiAgICApOgogICAgICAgICMgUHV0IHRoZSB0YXNrIGluIHRoZSBxdWV1ZToKICAgICAgICB0YXNrc19xdWV1ZS5wdXQodGFza19jcmVhdG9yLmNyZWF0ZV90YXNrKGF1ZGlvX2ZpbGU9YXVkaW9fZmlsZSkpCgogICAgIyBQdXQgdGhlIHN0b3AgbWFya3MgaW4gdGhlIHF1ZXVlOgogICAgZm9yIF8gaW4gcmFuZ2Uobl93b3JrZXJzKToKICAgICAgICB0YXNrc19xdWV1ZS5wdXQoX01VTFRJUFJPQ0VTU0lOR19TVE9QX01BUkspCgogICAgIyBXYWl0IGZvciB0aGUgcHJvY2Vzc2VzIHRvIGZpbmlzaDoKICAgIGZvciBwIGluIHRhc2tfY29tcGxldGlvbl9wcm9jZXNzZXM6CiAgICAgICAgcC5qb2luKCkKCiAgICAjIENvbGxlY3QgdGhlIHJlc3VsdHM6CiAgICByZXN1bHRzID0gW10KICAgIHN0b3BfbWFya3NfY291bnRlciA9IDAKICAgIHdoaWxlIFRydWU6CiAgICAgICAgIyBHZXQgYSByZXN1bHQgZnJvbSB0aGUgcXVldWU6CiAgICAgICAgcmVzdWx0OiBUdXBsZVtib29sLCBUdXBsZVtzdHIsIGxpc3RdXSA9IHJlc3VsdHNfcXVldWUuZ2V0KCkKICAgICAgICBpZiByZXN1bHQgPT0gX01VTFRJUFJPQ0VTU0lOR19TVE9QX01BUks6CiAgICAgICAgICAgIHN0b3BfbWFya3NfY291bnRlciArPSAxCiAgICAgICAgICAgIGlmIHN0b3BfbWFya3NfY291bnRlciA9PSBuX3dvcmtlcnM6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgQ29sbGVjdCB0aGUgcmVzdWx0OgogICAgICAgICAgICByZXN1bHRzLmFwcGVuZChyZXN1bHQpCgogICAgcmV0dXJuIHJlc3VsdHMKCgpkZWYgX3Byb2Nlc3NfcmVzdWx0cygKICAgIHJlc3VsdHM6IExpc3RbVHVwbGVbYm9vbCwgVHVwbGVbc3RyLCBsaXN0XV1dLCB2ZXJib3NlOiBib29sCikgLT4gVHVwbGVbZGljdCwgZGljdF06CiAgICAiIiIKICAgIFByb2Nlc3MgdGhlIHJlc3VsdHMgb2YgdGhlIHRhc2tzLgoKICAgIDpwYXJhbSByZXN1bHRzOiBUaGUgcmVzdWx0cyB0byBwcm9jZXNzLgogICAgOnBhcmFtIHZlcmJvc2U6IFZlcmJvc2l0eS4KCiAgICA6cmV0dXJuczogVGhlIHByb2Nlc3NlZCByZXN1bHRzIGFzIGEgdHVwbGUgb2Ygc3VjY2Vzc2VzIGFuZCBlcnJvcnMuCiAgICAiIiIKICAgIGlmIHZlcmJvc2U6CiAgICAgICAgX0xPR0dFUi5pbmZvKCJTdW1tYXJpemluZyB0aGUgcmVzdWx0cy4iKQogICAgc3VjY2Vzc2VzID0ge30KICAgIGVycm9ycyA9IHt9CiAgICBmb3IgaXNfZXJyb3IsIHJlc3VsdCBpbiByZXN1bHRzOgogICAgICAgIGlmIGlzX2Vycm9yOgogICAgICAgICAgICBlcnJvcnNbcmVzdWx0WzBdXSA9IHJlc3VsdFsxXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN1Y2Nlc3Nlc1tyZXN1bHRbMF1dID0gcmVzdWx0WzFdCiAgICBpZiB2ZXJib3NlOgogICAgICAgIF9MT0dHRVIuaW5mbyhmIkRvbmUgKHtsZW4oc3VjY2Vzc2VzKX0ve2xlbihzdWNjZXNzZXMpICsgbGVuKGVycm9ycyl9KVxuIikKCiAgICByZXR1cm4gc3VjY2Vzc2VzLCBlcnJvcnMK
    base_image: mlrun/mlrun
    commands: []
    code_origin: ''
    origin_filename: ''
    requirements:
    - torch
    - torchaudio
    - tqdm
  entry_points:
    audio_file:
      name: audio_file
      doc: Get the audio file of the task.
      parameters:
      - name: self
      outputs:
      - doc: The audio file of the task.
        type: Path
        default: ''
      lineno: 43
    do_task:
      name: do_task
      doc: Do the task on the given speech timestamps. The task will diarize the VAD
        speech timestamps into speakers.
      parameters:
      - name: self
      - name: speech_timestamps
        type: List[List[Dict[str, int]]]
        doc: The speech timestamps per channel to do the task on as outputted from
          the VAD.
      outputs:
      - default: ''
      lineno: 86
    get_result:
      name: get_result
      doc: Get the result of the task. A tuple of the audio file name and the result.
      parameters:
      - name: self
      outputs:
      - doc: The result of the task.
        default: ''
      lineno: 61
    create_task:
      name: create_task
      doc: Create a task with the given audio file.
      parameters:
      - name: self
      - name: audio_file
        type: Path
        doc: The audio file to assign to the task.
      outputs:
      - doc: The created task.
        default: ''
      lineno: 123
    load:
      name: load
      doc: Load the VAD model.
      parameters:
      - name: self
      outputs:
      - default: ''
      lineno: 199
    detect_voice:
      name: detect_voice
      doc: "Perform voice activity detection on given audio files using the silero\
        \ VAD model -\nhttps://github.com/snakers4/silero-vad. The end result is a\
        \ dictionary with the file names as keys and their\nVAD timestamps dictionaries\
        \ as value.\n\nFor example::\n\n    {\n        \"file_1.wav\": [\n       \
        \     {\"start\": 0, \"end\": 16000},\n            {\"start\": 16000, \"end\"\
        : 32000},\n            {\"start\": 32000, \"end\": 48000},\n            ...\n\
        \        ],\n        \"file_2.wav\": [\n            {\"start\": 0, \"end\"\
        : 16000},\n            {\"start\": 16000, \"end\": 32000},\n            {\"\
        start\": 32000, \"end\": 48000},\n            ...\n        ],\n        ...\n\
        \    }"
      parameters:
      - name: data_path
        type: Union[str, Path, List[Union[str, Path]]]
        doc: The path to the audio files to diarize. Can be a path to a single file,
          a path to a directory or a list of paths to files.
      - name: use_onnx
        type: bool
        doc: Whether to use ONNX for inference. Default is True.
        default: true
      - name: force_onnx_cpu
        type: bool
        doc: Whether to force ONNX to use CPU for inference. Default is True.
        default: true
      - name: threshold
        type: float
        doc: Speech threshold. Silero VAD outputs speech probabilities for each audio
          chunk, probabilities ABOVE this value are considered as SPEECH. It is better
          to tune this parameter for each dataset separately, but "lazy" 0.5 is pretty
          good for most datasets.
        default: 0.5
      - name: sampling_rate
        type: int
        doc: Currently, silero VAD models support 8000 and 16000 sample rates.
        default: 16000
      - name: min_speech_duration_ms
        type: int
        doc: Final speech chunks shorter min_speech_duration_ms are thrown out.
        default: 250
      - name: max_speech_duration_s
        type: float
        doc: Maximum duration of speech chunks in seconds. Chunks longer than `max_speech_duration_s`
          will be split at the timestamp of the last silence that lasts more than
          100ms (if any), to prevent aggressive cutting. Otherwise, they will be split
          aggressively just before max_speech_duration_s.
        default: float('inf')
      - name: min_silence_duration_ms
        type: int
        doc: In the end of each speech chunk wait for min_silence_duration_ms before
          separating it.
        default: 100
      - name: window_size_samples
        type: int
        doc: Audio chunks of window_size_samples size are fed to the silero VAD model.
        default: 512
      - name: speech_pad_ms
        type: int
        doc: Final speech chunks are padded by speech_pad_ms each side.
        default: 30
      - name: return_seconds
        type: bool
        doc: Whether return timestamps in seconds. False means to return timestamps
          in samples (default - False).
        default: false
      - name: per_channel
        type: bool
        doc: Whether to return timestamps per channel (default - False). This will
          run VAD on each channel separately and return a list of timestamps per channel.
        default: false
      - name: use_multiprocessing
        type: int
        doc: The number of workers to use for multiprocessing. If 0, no multiprocessing
          will be used. Default is 0.
        default: 0
      - name: verbose
        type: bool
        doc: Verbosity.
        default: false
      outputs:
      - default: ''
      lineno: 347
    diarize:
      name: diarize
      doc: "Perform speech diarization on given audio files using the silero VAD model\
        \ - https://github.com/snakers4/silero-vad.\nThe speech diarization is performed\
        \ per channel so that each channel in the audio belong to a different speaker.\
        \ The\nend result is a dictionary with the file names as keys and their diarization\
        \ as value. A diarization is a list\nof tuples: (start, end, speaker_label).\n\
        \nFor example::\n\n    {\n        \"file_1.wav\": [\n            (0.0, 1.0,\
        \ \"speaker_0\"),\n            (1.0, 2.0, \"speaker_1\"),\n            (2.0,\
        \ 3.0, \"speaker_0\"),\n            ...\n        ],\n        \"file_2.wav\"\
        : [\n            (0.0, 1.0, \"speaker_0\"),\n            (1.0, 2.0, \"speaker_1\"\
        ),\n            (2.0, 3.0, \"speaker_0\"),\n            ...\n        ],\n\
        \        ...\n    }"
      parameters:
      - name: data_path
        type: Union[str, Path, List[Union[str, Path]]]
        doc: The path to the audio files to diarize. Can be a path to a single file,
          a path to a directory or a list of paths to files.
      - name: use_onnx
        type: bool
        doc: Whether to use ONNX for inference. Default is True.
        default: true
      - name: force_onnx_cpu
        type: bool
        doc: Whether to force ONNX to use CPU for inference. Default is True.
        default: true
      - name: threshold
        type: float
        doc: Speech threshold. Silero VAD outputs speech probabilities for each audio
          chunk, probabilities ABOVE this value are considered as SPEECH. It is better
          to tune this parameter for each dataset separately, but "lazy" 0.5 is pretty
          good for most datasets.
        default: 0.5
      - name: sampling_rate
        type: int
        doc: Currently, silero VAD models support 8000 and 16000 sample rates.
        default: 16000
      - name: min_speech_duration_ms
        type: int
        doc: Final speech chunks shorter min_speech_duration_ms are thrown out.
        default: 250
      - name: max_speech_duration_s
        type: float
        doc: Maximum duration of speech chunks in seconds. Chunks longer than `max_speech_duration_s`
          will be split at the timestamp of the last silence that lasts more than
          100ms (if any), to prevent aggressive cutting. Otherwise, they will be split
          aggressively just before max_speech_duration_s.
        default: float('inf')
      - name: min_silence_duration_ms
        type: int
        doc: In the end of each speech chunk wait for min_silence_duration_ms before
          separating it.
        default: 100
      - name: window_size_samples
        type: int
        doc: Audio chunks of window_size_samples size are fed to the silero VAD model.
        default: 512
      - name: speech_pad_ms
        type: int
        doc: Final speech chunks are padded by speech_pad_ms each side.
        default: 30
      - name: speaker_labels
        type: List[str]
        doc: The speaker labels to use for the diarization. If not given, the speakers
          will be named "speaker_0", "speaker_1", etc.
        default: null
      - name: use_multiprocessing
        type: int
        doc: The number of workers to use for multiprocessing. If 0, no multiprocessing
          will be used. Default is 0.
        default: 0
      - name: verbose
        type: bool
        doc: Verbosity.
        default: false
      outputs:
      - default: ''
      lineno: 471
  description: Silero VAD (Voice Activity Detection) functions.
  default_handler: detect_voice
  disable_auto_mount: false
  clone_target_dir: ''
  env: []
  priority_class_name: ''
  preemption_mode: prevent
  affinity: null
  tolerations: null
  security_context: {}
verbose: false
